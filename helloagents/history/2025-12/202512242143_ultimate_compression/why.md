# 变更提案: 终极压缩与自洽迭代

## 需求背景
在完成“奇点重构”（自包含 + PWA + 安全基线）后，项目仍存在进一步演进空间：
- **重复实现与重复策略**：JS 里存在可抽象的重复流程（mailto 构造、可见性切换、DOM 查询等）。
- **CSS 冗余与覆盖链过长**：`assets/styles.css` 存在多段重复 selector 定义（例如 `.navbar`/`.hero`/`.btn` 多处出现），导致维护成本与文件体积上升，并增加未来修改的不可预期性。
- **缺少“构建级极限压缩”路径**：当前运行时已零依赖，但缺少可选的“生产构建压缩”工具链（Tree-shaking / 压缩 / 资源处理）用于部署到更严格的性能预算场景。

## 产品分析

### 目标用户与场景
- **用户群体:** 需要商业级静态作品集模板的独立创作者/开发者
- **使用场景:** GitHub Pages/Netlify/Vercel 部署、弱网访问、移动端访问、现场展示
- **核心痛点:** 维护成本、样式覆盖风险、难以进一步压榨产物体积

### 价值主张与成功指标
- **价值主张:** 在不破坏“直接打开 index.html 可用”的前提下，提供可选的“极限构建压缩”能力，并彻底降低冗余与覆盖链复杂度。
- **成功指标（可验证）:**
  - JS 重复逻辑收敛到可复用工具函数（更少的重复实现点）
  - CSS 主定义收敛：关键 selector（navbar/hero/btn/container 等）不再多处重复定义
  - 新增 Vite 构建配置（不影响零依赖运行），支持 minify + tree-shaking（面向生产）
  - README 新增“未来进化蓝图”，明确未来 3 个版本的演进方向与里程碑

### 人文关怀
- **可维护性:** 通过“可读的抽象”替代“过度魔法化”，避免为了压缩而牺牲可理解性。
- **可移植性:** 保留纯静态的开箱即用能力，构建工具链仅作为可选增强。

## 变更内容
1. JS：抽象重复逻辑为工具函数（mailto、可见性、DOM 查询、节流等）。
2. CSS：去重与合并重复规则，缩短覆盖链，保留最终视觉效果。
3. 构建：新增 Vite 构建配置，提供极限压缩的生产构建路径。
4. 文档：README 新增“未来进化蓝图”，并同步知识库与变更记录。

## 影响范围
- **模块:** styles / interactions / build-tooling / docs
- **文件:** `assets/app.js`, `assets/styles.css`, `README.md`, `package.json`, `vite.config.*` 等

## 核心场景

### 需求: 运行时零依赖保持
**模块:** static-ui / interactions
在不安装任何依赖的情况下，`index.html` 仍可直接打开预览并保持主要交互可用。

#### 场景: 双击打开
前置条件：用户直接打开 `index.html`
- 预期结果：页面正常渲染与交互可用（主题/导航/筛选/表单回退）

### 需求: 生产构建极限压缩（可选）
**模块:** build-tooling
在需要更小产物与更严格性能预算时，可通过构建脚本生成最小化产物用于部署。

#### 场景: 部署到静态托管
前置条件：用户执行构建命令
- 预期结果：生成 `dist/`，体积更小、可部署、功能一致

## 风险评估
- **风险:** CSS 去重可能造成细微视觉差异
  - **缓解:** 以最终生效规则为基准合并，并执行快速烟测（尤其 navbar/hero/卡片/按钮）
- **风险:** 引入构建工具链增加维护面
  - **缓解:** 构建能力作为可选增强，不改变“零依赖可运行”的默认路径

